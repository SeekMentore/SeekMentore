<?xml version="1.0" encoding="UTF-8"?>
<queryMapper namespace="employee">
	<query type="select" id="selectEmployee">
		SELECT
            EMP.*,
            (SELECT EMAIL_ID FROM EMPLOYEE_EMAIL_ID EMPE WHERE EMPE.EMPLOYEE_ID = EMP.EMPLOYEE_ID AND EMPE.IS_PRIMARY = 'Y') AS EMAIL_ID,
    		(SELECT CONTACT_NUMBER FROM EMPLOYEE_CONTACT_NUMBER EMPC WHERE EMPC.EMPLOYEE_ID = EMP.EMPLOYEE_ID AND EMPC.IS_PRIMARY = 'Y') AS CONTACT_NUMBER,
            IFNULL((SELECT NAME FROM EMPLOYEE E WHERE E.USER_ID = EMP.UPDATED_BY), EMP.UPDATED_BY) AS UPDATED_BY_NAME
        FROM EMPLOYEE EMP
	</query>
	<query type="filter" id="employeeUserIdFilter">
		WHERE LOWER(USER_ID) = LOWER(:userId)
	</query>
	<query type="update" id="updateEmployeePassword" paramClass="com.model.User">
		UPDATE EMPLOYEE SET 
			ENCRYPTED_PASSWORD = :encryptedPassword 
		WHERE USER_ID = :userId
	</query>
</queryMapper>